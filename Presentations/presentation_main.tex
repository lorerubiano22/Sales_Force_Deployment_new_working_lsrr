\documentclass[xcolor=dvipsnames,aspectratio=169, handout, mathserif]{beamer}
\usetheme[progressbar=frametitle]{metropolis}


% The first few packages are must-haves:
\usepackage{appendixnumberbeamer}
\usepackage{booktabs}
\usepackage[scale=2]{ccicons}
\usepackage{pgfplots}
\usepgfplotslibrary{dateplot}
\usepackage{xspace}
\newcommand{\themename}{\textbf{\textsc{metropolis}}\xspace}
\usepackage{fontspec}
\usepackage[T1]{fontenc}
%\usepackage[utf8]{inputenc}
\usepackage{geometry}
\usepackage{graphicx}
\usepackage{makeidx}
\usepackage{microtype} % typographic adjustments
\usepackage{xcolor} % colors (also colored tables)
\usepackage{multirow} % span multiple rows with a single cell
\usepackage{tikz} % THE package for drawing all sorts of things
\usepackage{listings} % used for code excerpts    
\usepackage{bm}             
\usepackage{algorithmicx}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\tikzset{font=\sffamily}
%%%%%%% New packages %%%%%%%

%%% package for project %%%%

\usepackage{etoolbox}
\usepackage{framed}
\usepackage{hyperref}
\usepackage[ngerman, american]{babel}
\usepackage{amsmath,amsfonts,amssymb}
\usepackage{multimedia}
\usepackage{media9}
\usepackage{animate}
\usepackage{graphicx}
\usepackage{transparent}
\usepackage{dcolumn}
\usepackage{booktabs}
\usepackage{subfigure}
\usepackage{pgfpages}
\usepackage{tikz,pgfplots}
	\pgfplotsset{compat=newest}
    \usetikzlibrary{backgrounds}
    \usepgfplotslibrary{units}
\usetikzlibrary{fadings,shapes.arrows,arrows.meta,shadows,decorations,backgrounds,shapes,calc,arrows,chains}
\usepackage{smartdiagram}
\usepackage{xparse}
\usepackage{algorithmicx}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\usepackage{listings}
\usepackage{textcomp}
\lstloadlanguages{R}
\usepackage{mathtools}
\usepackage[mode=buildnew]{standalone}
%%%%%%% more from the project %%%%%%%

\setbeamerfont{frametitle}{series=\bfseries}
\useinnertheme{rectangles}
\setbeamertemplate{blocks}[default]
\setbeamertemplate{caption}{\insertcaption}
\setbeamertemplate{itemize item}[triangle]
\setbeamercovered{transparent, dynamic}

\definecolor{mygreen}{RGB}{29, 152, 37}
\definecolor{myorange}{RGB}{217,95,2}
\definecolor{myblue}{RGB}{117,112,179}
\definecolor{myred}{rgb}{0.76, 0.16, 0.15}
\definecolor{OVGUblue1}{RGB}{242,246,248} % helles OVGU Blau
\definecolor{OVGUblue2}{RGB}{174,198,210} % EUV Grey (secondary) %mittleres OVGU Blau
\definecolor{OVGUblue3}{RGB}{93,142,166} % EUV Yellow (primary) %dunkles OVGU blau
\definecolor{OVGUblue4}{RGB}{0,104,180} % Fakultät für Informatik
\definecolor{OVGUred1}{RGB}{122,0,63}
\definecolor{OVGUred2}{RGB}{188,127,159}
\definecolor{OVGUred3}{RGB}{245,235,240}




%%%%%


%define some specifit color for code sections
\definecolor{red}{RGB}{220,0,0}
\definecolor{fin}{RGB}{0,105,180}
\definecolor{blue}{named}{fin}
\definecolor{green}{RGB}{73,125,0}
\definecolor{yellow}{RGB}{243,155,12}
\definecolor{pdflinkcolor}{RGB}{0,0,0}
\definecolor{pdfcitecolor}{RGB}{6,116,0}
\definecolor{light-gray}{gray}{0.9}
\definecolor{lightest-gray}{gray}{0.99}
\definecolor{white}{RGB}{255,255,255} % Define color with opacity

%RWTH Farbwelt
\definecolor{RWTH-Blue-100}{RGB}{0,84,159}
% \definecolor{RWTH-Blue-75}{RGB}{64,127,183}
\definecolor{RWTH-Blue-50}{RGB}{142,186,229}
\definecolor{RWTH-Blue-25}{RGB}{199,221,242}
% \definecolor{RWTH-Blue-10}{RGB}{232,241,250}
\definecolor{RWTH-Green-100}{RGB}{87,171,39}
% \definecolor{RWTH-Green-75}{RGB}{141,192,96}
% \definecolor{RWTH-Green-50}{RGB}{184,214,152}
% \definecolor{RWTH-Red-100}{RGB}{204,7,30}
\definecolor{RWTH-Red-75}{RGB}{216,92,65}


%Add chair logo to title page
\titlegraphic{%
   \begin{picture}(0,0)
     \put(425,20){\makebox(0,0)[rt]{\includegraphics[width=5cm]{rwth_lehrstuhl_fuer_data_and_business_analytics_de_rgb.png}}}
   \end{picture}}


%changing color theme and logo
\usepackage{demo}


%to show the page number as a fraction with a forward slash
\setbeamertemplate{frame numbering}[fraction]

%to show author and title
\setbeamertemplate{frame footer}{ \insertshortauthor{}, \insertshorttitle}

%change Font
\setsansfont{Open Sans}

\setbeamerfont{frame footer}{size=\fontsize{5}{5}\selectfont}
\setbeamerfont{page number in head/foot}{size=\fontsize{5}{5}\selectfont}

%change size of progress bar
\makeatletter
\setlength{\metropolis@titleseparator@linewidth}{2pt}
\setlength{\metropolis@progressonsectionpage@linewidth}{1.8pt}
\setlength{\metropolis@progressinheadfoot@linewidth}{2pt}
\makeatother



\lstloadlanguages{R}

\lstdefinestyle{RStyle} {    language=R,
    backgroundcolor=\color{gray!25},
    basicstyle=\scriptsize\ttfamily,
    otherkeywords={0,1,2,3,4,5,6,7,8,9},
    morekeywords={TRUE,FALSE},
    deletekeywords={data,frame,length,as,character},
    keywordstyle=\color{orange},
    identifierstyle=\color{blue},
    commentstyle=\color{purple},
    stringstyle=\color{black!80},
    numbers=left,
    numberstyle=\tiny\color{gray},  
    stepnumber=1,
    numbersep=5pt,
    escapechar=?,
    breaklines=true,
    moredelim=**[is][\color{blue}]{^}{^},
    moredelim=**[is][\color{orange}]{*}{*}
}



\lstdefinelanguage{GAMS}{
    morekeywords={
        ABORT, ACRONYM, ACRONYMS, ALIAS, ALL, AND, ASSIGN, BINARY, CARD, DISPLAY, EPS, EQ, EQUATION,
        EQUATIONS, GE, GT, INF, INTEGER, LE, LOOP, LT, MAXIMIZING, MINIMIZING, MODEL, MODELS, NA, NE,
        NEGATIVE, NOT, OPTION, OPTIONS, OR, ORD, PARAMETER, PARAMETERS, POSITIVE, PROD, SCALAR, SCALARS,
        SET, SETS, SMAX, SMIN, SOS1, SOS2, SUM, SYSTEM, TABLE, USING, VARIABLE, VARIABLES, XOR, YES,
        REPEAT, UNTIL, WHILE, IF, THEN, ELSE, SEMICONT, SEMIINT, FILE, FILES, PUT, PUTPAGE, PUTTL,
        PUTCLOSE, FREE, NO, SOLVE, FOR, ELSEIF, ABS, ARCTAN, CEIL, COS, ERROR, EXP, FLOOR, LOG,
        LOG10, MAP, MAPVAL, MAX, MIN, MOD, NORMAL, POWER, ROUND, SIGN, SIN, SQR, SQRT, TRUNC,
        UNIFORM, LO, UP, FX, SCALE, PRIOR, PC, PS, PW, TM, BM, CASE, DATE, IFILE, OFILE, PAGE, RDATE,
        RFILE, RTIME, SFILE, TIME, TITLE, TS, TL, TE, TF, LJ, NJ, SJ, TJ, LW, NW, SW, TW, ND, NR, NZ,
        CC, HDCC, TLCC, LL, HDLL, TLLL, LP, WS, /, PROD:
    },
    sensitive = false,
    morecomment=[f]*,%
    morecomment=[s]{$ontext}{$offtext},
    morecomment=[s][\color{green}]{/}{/},
    morestring=[b]”,
    morestring=[b]’
}

\lstdefinestyle{GAMSStyle}{
language={GAMS},
% basicstyle=\fontfamily{cmss}\fontseries{m}\selectfont\footnotesize,
basicstyle=\scriptsize\ttfamily,
commentstyle=\color{gray}\itshape,
keywordstyle=\color{blue}\bfseries,
stringstyle=\color[rgb]{0.5,0,0.5}\itshape,
showstringspaces=false,
numbers=left,
numberstyle=\color[rgb]{0,0.5,0.5}\fontfamily{cmss}\fontseries{m}\selectfont\tiny,
numberblanklines=false,
showlines=false,
belowskip=\bigskipamount{},
breaklines=true,
%stepnumber=2,
tabsize=6,
escapechar=?,
%extendedchars=true,
%float=h,
frame=tb
}
\newcommand{\blue}[1]{\textcolor{blue}{#1}} % changes textcolor to blue, i.e., \blue{a}
\newcommand{\prof}{Univ.-Prof. Dr. Sven M\"uller}
\newcommand{\course}{Modular Capacitated Sales Force Deployment Problem}% 

\title{ \course }
%\subtitle{Overview}
\date{\today}
\date{}
\author[Müller et al.]{\textbf{{\sffamily Sven Müller, Lorena Reyes-Rubiano, Lucas Weber }}}
\institute{{\sffamily Chair of Data \& Business Analytics\\ RWTH Aachen University}}
\date{\textcolor{white}{ff\\ff\\}}


\begin{document}

\maketitle


\begin{frame}{\textbf{Subproblems in Sales Force Deployment}}
\begin{figure}
 \begin{minipage}[b]{0.45\linewidth} \centering
  \input{SFDsize2.tex}\\
	Sales force size 
 \end{minipage}
\uncover<2->{
 \begin{minipage}[b]{0.45\linewidth} \centering
	\input{SFDlocate2.tex}\\
	Salespersons' location
	\end{minipage}
	}
	\vspace{0.1cm}
	\uncover<3->{
	\begin{minipage}[b]{0.45\linewidth} \centering
	\input{SFDalign2.tex}\\
	Sales territory alignment
	\end{minipage}
	}
	\uncover<4->{
	\begin{minipage}[b]{0.45\linewidth} \centering
	\input{SFDallocate2.tex}\\
	Resource allocation
	\end{minipage}
	}
\end{figure}
\end{frame}


\begin{frame}
	\frametitle{\textbf{Outline}}
	\tableofcontents
	\end{frame}

\section{Terminology \& Problem}

\begin{frame}{\textbf{Terminology}}
\begin{itemize}
	\item \textbf{Sales coverage unit} (SCU): containing customers and/or salespersons

\includestandalone[width=0.8\linewidth]{sales_area_plain.tex}
\end{itemize}
\end{frame}

\begin{frame}{\textbf{Terminology}}
\begin{itemize}
	\item \textbf{Sales coverage unit} (SCU): containing customers and/or salespersons
\end{itemize}
	\begin{itemize}[<+->]
	\item \textbf{Selling time}: optimally allocated to customers within an SCU
	\begin{itemize}
	  \item[$=$] sum of 
		\item Travel time: approximated by (function of) distance between SCUs
	  \item Calling time: 
		\begin{itemize}
			\item time at customer (product presentation, f.e.) 
			\item depends on travel time
		\end{itemize}
	\end{itemize}	
	\item \textbf{Sales}: function of selling time
	\item \textbf{Cost}:
	\begin{itemize}
	\item Fixed locational cost: fixed part of salary, rent
	\item Travel cost: function of distance
	\end{itemize}
	\item \textbf{Profit contribution}: function of sales and travel cost
	\item \textbf{Total profit} (Objective): function of profit contribution and fixed cost
\end{itemize}
\end{frame}


\begin{frame}
\begin{center}
{\LARGE \textbf{Profit Contribution}}
\end{center}
\end{frame}

\begin{frame}{\textbf{Coefficients of the Objective Function}}
\begin{description}
	\item[$J$]       set of sales coverage units (SCUs), indexed by $j$ and $v$
  \item[$I$]       set of SCUs ($I \subseteq J$) for locating teams of salespersons, indexed by $i$
\end{description}
\begin{center}
\includestandalone[width=0.7\linewidth]{sales_area_locs.tex}
\end{center}

\end{frame}

\begin{frame}{\textbf{Coefficients of the Objective Function}}
\begin{description}
	\item[$J$]       set of sales coverage units (SCUs), indexed by $j$ and $v$
  \item[$I$]       set of SCUs ($I \subseteq J$) for locating teams of salespersons, indexed by $i$
  \item[$M$] maximum allowed sales team size with $m = 1,\dots,M$
  \item[$T$] maximum selling time available per salesperson per period
%  \item[$\mathfrak{T}$] maximum selling time available per location with $\mathfrak{T}=\mathcal{S} \cdot|M|$
  \item[$t$]       selling time with $t \in \left[0,T \cdot M\right]$									
  \item<2->[$s_{ij}(t)$]  sales response function
  \item<2->[$k_{ij}(t)$]  selling cost function
	\item<2->[$\alpha$] per unit profit contribution of sales
\end{description}
\vfill
\uncover<2->{
\begin{block}{\textbf{Profit Contribution Function}}
\begin{equation}
   p_{ij}(t) =  \alpha \cdot s_{ij}(t) - k_{ij}(t) 
\end{equation}
\end{block}
}
\end{frame}





\begin{frame}{\textbf{Profit Contribution Function}}
\begin{columns}
\column{0.5\linewidth}
\centering
\begin{align*}
\Aboxed{p_{ij}(t) &= c_{ij} \cdot t^b - o_{ij} \cdot t}\\
0 &< b < 1 \\
c_{ij} &\geq 0 \\
o_{ij} &\geq 0 \\
%c_{ij} &=  \alpha \cdot \mu \cdot n_j \, (1- \beta_{ij})^b\\
%o_{ij} &=  h \cdot \beta_{ij}
\end{align*}
\column{0.5\linewidth}
\begin{figure}[h!]
	\centering
%		\includegraphics[width=1.00\textwidth]{ProfitContri_Elast.pdf}
\scalebox{1.5}{
\input{TEX_ProfitContri_Elast.tex}
}
	\label{fig:ProfitContri_Elast}
\end{figure}
%$c_{ij}=1$ and $o_{ij}=0$
\end{columns}
\end{frame}


\begin{frame}{\textbf{Sales Force Deployment Problem}}
\begin{block}{\textbf{Problem Statement}}
Determine the appropriate \textbf{sales force size} and corresponding \textbf{locations}, construct a
contiguous \textbf{sales territory} for each salesteam, and allocate the total available
\textbf{selling time} of each salesteam over its sales territory so that the sum of \textbf{profit}
contributions obtained by the salespersons less the fixed location costs is \textbf{maximized}.
\end{block}
\begin{figure}
\centering
 \begin{minipage}[b]{0.2\linewidth} \centering
  \input{SFDsize2.tex}
	\footnotesize Sales force size 
 \end{minipage}
 \begin{minipage}[b]{0.2\linewidth} \centering
	\input{SFDlocate2.tex}
	\footnotesize Salespersons' location
	\end{minipage}
	\begin{minipage}[b]{0.25\linewidth} \centering
	\input{SFDalign2.tex}\\
	\footnotesize Sales territory alignment
	\end{minipage}
	\begin{minipage}[b]{0.2\linewidth} \centering
	\input{SFDallocate2.tex}
	\footnotesize Resource allocation
	\end{minipage}
\end{figure}
\end{frame}


\section{Model Formulation}

\begin{frame}{\textbf{Additional Notation}}
\textbf{Sets and parameters}
\begin{description}
	\item[$J_i$]     set of SCUs assignable to a salesteam located in SCU $i$ ($J_i \subseteq J$)
\end{description}
\uncover<2->{
\begin{center}
\includestandalone[width=0.65\linewidth]{sales_area_potentialTerritory.tex}
\end{center}
}
\end{frame}

\begin{frame}{\textbf{Additional Notation}}
\vspace{-2mm}
\textbf{Sets and parameters}
\vspace{-2mm}
\begin{description}
	\item[$J_i$]     set of SCUs assignable to a salesteam located in SCU $i$ ($J_i \subseteq J$)
  \item[$A_j$]		 set of SCUs adjacent to SCU $j$
  %\item[$T$]       total available selling time of a salesperson per period
  \item[$f_{im}$]   fixed cost per period for locating $m$ salespersons in SCU $i$
\end{description}
\vspace{-2mm}
\uncover<2->{
\textbf{Binary variables}
\vspace{-2mm}
\begin{description}
	  \item[$y_{im}$]  =1, if a location is set up in SCU $i$ for a salesteam of size $m$  ($y_{im} = 0$, otherwise)
  \item[$w_{ij}$] =1, if SCU $j$ is assigned to location $i$ ($w_{ij} = 0$, otherwise)
\end{description}
}
\vspace{-2mm}
\uncover<3->{
\textbf{Non-negative variables}
\vspace{-2mm}
\begin{description}
  \item[$x_{ijt}$]  =1, if salesteam located in SCU $i$ is allocating a selling time of $t$ to SCU $j$     ($x_{ijt} = 0$, otherwise)
  \item[$q_{ivj}$] quantity of flow from $v$ to $j$ with origin in location $i$; artificial variable (contiguity)
\end{description}
}
\end{frame}

\begin{frame}{\textbf{Model Formulation Based on Haase/Müller (2014)}}
\vspace{-5mm}
\footnotesize
\begin{equation}
 \text{Maximize } \ F =  \sum_{i \in I} \sum_{j \in J_i} \sum_{t \in [0,T \cdot M]} p_{ij}(t)  x_{ijt} - \sum_{i \in I} \sum_{m=1}^M f_{im} y_{im}  \label{sfd-mod-of}
\end{equation}

\begin{align}
\text{Time Allocation} && \sum_{ j \in J_i} \sum_{t\in [0,T \cdot M]} t \cdot x_{ijt} &\leq T \cdot \sum_{m=1}^M m \cdot y_{im}  &i \in I \\
\text{Sales Team Assignment} && \sum_{m=1}^M y_{im} &\le 1 &i \in I \\
\text{Cuts} && w_{ij} &\le  \sum_{m = 1}^M y_{im} &i \in I,  j \in J_i 
\end{align}
\normalsize
\uncover<2->{
Unchanged constraints (Haase/Müller (2014)):
\begin{itemize}
    \item SCU Assignment (coupling of $x_{ijt}$ and $w_{ij}$)
    \item Distinct Assignment (a SCU can only be assigned to one or none location)
    \item Contiguity Constraints (SCUs within each sales territory must be connected)
\end{itemize}}
\end{frame}


\section{Solution Approach}


\begin{frame}{\textbf{Semi-Infinite Linear Program}}
\begin{block}{Issue}
Infinite number of variables $x_{ijt}$ due to $t \in \left[ 0,T \cdot M \right]$
\end{block}
\bigskip
\uncover<2->{
\textbf{Solution}
}
\begin{itemize}
  \item<2-> Relax integrality of $w_{ij}$ and $y_{im}$ (LP-relaxation)
  \item<3-> Replace $[0,T \cdot M]$ by finite subset $T_{ij} \subset [0,T \cdot M]$  
	\item<4-> Solve LP-relaxation by column generation
	\item<5-> Branch-and-Price to obtain integer solution
\end{itemize}
\vfill
\uncover<2->{
\textbf{Outcome}
}
\begin{itemize}
  \item<2-> \uncover<3->{Restricted} Master Problem
  \item<5-> Upper and lower bounds on the semi-infinte MIP
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Piece-wise Linear Reformulation by Column Generation}
\begin{center}
\begin{figure}
    \centering
    \includegraphics[width=0.8\linewidth]{p8.png}
\end{figure}
\end{center}
\end{frame}

\begin{frame}
\frametitle{Column Generation Outline}
\begin{center}
\scalebox{0.55}{
\input flow_chart_CG.tex
}
\end{center}
\end{frame}



%\begin{frame}{Non-Linear Fixed Cost}
%\textbf{Parameters}
%    \begin{description}
%	  \item[$S$]  fixed part of salary per sales representative
%  \item[$R_i$] base administration costs at location $i$ (mainly rent for office rooms) 
%  \item[$\rho$] cost degression for administration costs ($0\leq \rho \leq 1$)
%\end{description}
%\begin{align}
%    f_{im} = R_i \cdot m^\rho + S \cdot m
%\end{align}
%\end{frame}

\begin{frame}{Non-Linear Fixed Cost}
\textbf{Parameters}
    \begin{description}
	  \item[$S$]  fixed part of salary per sales representative
  \item[$R_i$] base administration costs at location $i$ (mainly rent for office rooms) 
  \item[$\rho$] cost degression for administration costs ($0\leq \rho \leq 1$)
\end{description}
\vfill
\begin{align}
    f_{im} = R_i \cdot m^\rho + S \cdot m
\end{align}
\end{frame}

\begin{frame}{Bound-Strengthening}
    \begin{equation}
        \max F = \sum_{i \in I} \sum_{j \in J_i} \sum_{t \in [0,T \cdot M]} p_{ij}(t)  x_{ijt} - \sum_{i \in I} \sum_{m=1}^M f_{im} y_{im}
    \end{equation}
    subject to (3)--(5), HM2014 constraints, and
    \begin{align}
        y_{im} &\leq \theta_{im} & \forall i, m = 1\\
        y_{im} &\leq \theta_{i,m-1} + \theta_{im}  & \forall i, m = 2,\dots,M-1 \\
        y_{im} &\leq \theta_{i,m-1} & \forall i, m = M \\
        \sum_{m=1}^{M-1} \theta_{im} &= 1 & \forall i \\
        \theta_{im} &\in \{0,1\} & \forall i \in I, \ \ m = 1,\dots,M
    \end{align}
\end{frame}



\section{Results}

\begin{frame}{\textbf{Artificial Sales Area - Visualization}}
\begin{center}
    \includestandalone[width=0.75\linewidth]{sales_area.tex}
\end{center}
\end{frame}

\begin{frame}{\textbf{Artificial Sales Area - Results}}
\centering
\begin{minipage}{0.47\linewidth}
\begin{center}
    $M = 1$\\[0.5em]
    \includestandalone[width=\linewidth]{solu_mip_m1} \\[-0.5cm]
   % \begin{center}
   % \underline{F}&=689,880.00 \\
   % \text{Sales} &= 1,235,106.40 \\
   % \text{Fixed Cost} &= 499,000 \\
   % \text{Travel Cost} &= 43,224.50
  %  \end{center}
\end{center}
\end{minipage}
\begin{minipage}{0.47\linewidth}
\begin{center}
    $M=5$ \\[0.5em]
    \includestandalone[width=\linewidth]{solu_mip_m5} \\[-0.5cm]
  %  \begin{center}
  %  \underline{F}&=707,371.00 \\
  %  \text{Sales} &= 1,252,597.10 \\
  %  \text{Fixed Cost} &= 499,000 \\
  %  \text{Travel Cost} &= 79,103.60
  %  \end{center}
\end{center}
\end{minipage}
\end{frame}


\begin{frame}{Computational Study with Bound Strengthening}
\begin{table}[]
\resizebox{1.05\textwidth}{!}{%
\begin{center}
    \small
    \begin{tabular}{cccrrrr|rrrr|rr}
  \cline{4-11}
 &  &  & \multicolumn{4}{c|}{Bound strengthening} & \multicolumn{4}{c}{With bound strengthening} &  &  \\ \midrule
        $|J|$ & $|I|$ & $M$ & $\overline{F}_0/100$ & \begin{tabular}[c]{@{}c@{}} $\underline{F}/100$ \\ (a)\end{tabular} & \begin{tabular}[c]{@{}c@{}}$\epsilon$ \\ (\%) \end{tabular}& \begin{tabular}[c]{@{}c@{}} $\text{CPU-Time}$ (sec.) \\ (b) \end{tabular}& $\overline{F}_0/100$ & \begin{tabular}[c]{@{}c@{}} $\underline{F}/100$ \\ (c)\end{tabular} & \begin{tabular}[c]{@{}c@{}}$\epsilon$ \\ (\%) \end{tabular}& \begin{tabular}[c]{@{}c@{}} $\text{CPU-Time}$ (sec.) \\ (d) \end{tabular}& \begin{tabular}[c]{@{}c@{}} Gap \\ $\frac{(a-c)*100}{a}$ \end{tabular} & \begin{tabular}[c]{@{}c@{}}  Gap \\ $\frac{(b-d)*100}{b}$ \end{tabular}\\ \midrule
       36 & 12 & 5 & 7,119.01 & 7,073.71 & 0.64 & 50.93 & 7,081.22 & 7,073.71 & 0.11 & 6.89 & 0.00 & 86.47 \\
36 & 12 & 1 & 7,080.91 & 6,898.80 & 2.57 & 13.91 & 7,081.22 & 7,073.71 & 0.11 & 6.86 & -2.54 & 50.68 \\ \midrule
64 & 20 & 5 & 11,785.40 & 11,540.20 & 2.08 & 175.77 & 12,003.60 & 11,746.90 & 2.14 & 194.89 & -1.79 & -10.88 \\
64 & 20 & 1 & 11,541.70 & 11,540.20 & 0.01 & 21.45 & 11,541.50 & 11,540.20 & 0.01 & 13.84 & 0.00 & 35.48 \\ \midrule
100 & 30 & 5 & 19,104.70 & 19,050.60 & 0.28 & 7200.02 & 19,411.40 & 19,050.60 & 1.86 & 3487.44 & 0.00 & 51.56 \\
100 & 30 & 1 & 18,855.70 & 18,804.50 & 0.27 & 311.87 & 18,855.90 & 18,804.50 & 0.27 & 147.72 & 0.00 & 52.63 \\ \midrule
225 & 50 & 5 & 41,929.40 & 41,367.50 & 1.34 & 7728.47 & 42,730.30 & 41,296.60 & 3.36 & 7287.36 & 0.17 & 5.71 \\
225 & 50 & 1 & 41,407.10 & 41,406.60 & 0.00 & 2676.03 & 41,450.20 & 41,407.10 & 0.10 & 1613.75 & 0.00 & 39.70 \\ \bottomrule
    \end{tabular}
\end{center}
}
\end{table}
$\epsilon=\left(\frac{\overline{F}_0-\underline{F}}{\overline{F}_0} \right) \cdot 100$
\end{frame}


\begin{frame}{Computational Study with Bound Strengthening}
\begin{center}
    \small
    \begin{tabular}{cccrrrrr}
    \toprule
        $|J|$ & $|I|$ & $M$ & $\overline{F}_0/100$ & $\underline{F}/100$ & $\epsilon$ &  $\text{CPU-Time}$ (sec.)  \\ \midrule
        36 & 12 & 5 & 7,119.01 &7,073.71 & 0,64 \%  & 50.93 \\
        36 & 12 & 1 & 7,080.91 & 6,898.80 & 2,57\%   & 13.91  \\ \midrule
        64 & 20 & 5 & 11,785.40 & 11,540.20 & 2,08 \%  & 175.77  \\
        64 & 20 & 1 & 11,541.70 & 11,540.20 & 0.01 \% & 21.45 \\ \midrule
        100 & 30 & 5 & 19,104.70 & 19,050.60 & 0.28 \%  & 7200.02 \\
        100 & 30 & 1 & 18,855.70 & 18,804.50 & 0.27 \%  & 311.87 \\ \midrule 
        225 & 50 & 5 & 41,929.40 & 41,367.50 & 1.34 \%  & 7728.47  \\
        225 & 50 & 1 & 41,407.10 & 41,406.60 & 0.00 \%  & 2676.03  \\ \bottomrule
    \end{tabular}
\end{center}
$\epsilon=\left(\frac{\overline{F}_0-\underline{F}}{\overline{F}_0} \right) \cdot 100$
\end{frame}


\begin{frame}{Computational Study without Bound Strengthening}
\begin{center}
    \small
    \begin{tabular}{cccrrrrr}
    \toprule
        $|J|$ & $|I|$ & $M$ & $\overline{F}_0/100$ & $\underline{F}/100$ & $\epsilon$ &  $\text{CPU-Time}$ (sec.)  \\ \midrule
        36 & 12 & 5 & 7,081.22 & 7,073.71 & 0.11 \%  & 6.89 \\
        36 & 12 & 1 & 7,081.22 & 7,073.71 & 0.11 \%   & 6.86  \\ \midrule
        64 & 20 & 5 & 12,003.60 & 11,746.90 & 2.14 \%  & 194.89  \\
        64 & 20 & 1 & 11,541.50 & 11,540.20 & 0.01 \% & 13.84 \\ \midrule
        100 & 30 & 5 & 19,411.40 & 19,050.60 & 1.86 \%  & 3487.44 \\
        100 & 30 & 1 & 18,855.90 & 18,804.50 & 0.27 \%  & 147.72 \\ \midrule 
        225 & 50 & 5 & 42,730.30 & 41,296.60 & 3.36 \%  & 7287.36  \\
        225 & 50 & 1 & 41,450.20 & 41,407.10 & 0.10 \%  & 1613.75  \\ \bottomrule
    \end{tabular}
\end{center}
$\epsilon=\left(\frac{\overline{F}_0-\underline{F}}{\overline{F}_0} \right) \cdot 100$
\end{frame}


\section{Outlook}


\begin{frame}{\textbf{Outlook}}
    \begin{itemize}[<+->]
     \item fair sales territory design
     \item simultaneous districting-scheduling problem
     \item alignment of "sub-territories" for sales territories with sales team sizes > 1
     \item Application: CLAAS South Africa
    \end{itemize}
\end{frame}


\appendix
\section{Backup slides}

\begin{frame}{Concave Sales Response Function}
\textbf{Skiera/Albers, 1998 \& Drexl/Haase, 1999}:
\begin{equation} \label{sfd-sales-response-function}
s_{ij}(t) = \mu \cdot n_j \, (\, (\, 1- \beta_{ij} \,)\, t\, ) ^ b 
\end{equation}

\textbf{cost function}:
\begin{equation} \label{sfd-cost-function}
k_{ij}(t) = h \cdot \beta_{ij} \cdot t
\end{equation}
\vfill
\begin{description}
    \item[$\mu$]  scaling parameter ($\mu > 0$)
     \item[$n_j$] indicator for the 'calling time profitability' of SCU $j$ 
     \item[$\beta_{ij}$] travel time fraction of the selling time allocated to SCU $j$ 
                    by the salespersons located in SCU $i$
                   ($0 < \beta_{ij} < 1$)
			\item[$b$] calling time elasticity ($0< b < 1$)						
     \item[$h$]     cost per travel time unit ($h \ge 0$)
		\end{description}
\end{frame}
\section{Complete Model Formulation}


\begin{frame}{\textbf{Model Formulation}}

\tiny
\begin{equation}
\text{Maximize } \ F =  \sum_{i \in I} \sum_{j \in J_i} \sum_{t \in [0,T \cdot M]} p_{ij}(t)  x_{ijt} - \sum_{i \in I} \sum_{m=1}^M f_{im} y_{im} 
\end{equation} 

\begin{align}
    \sum_{ j \in J_i} \sum_{t\in [0,T \cdot M]} t \cdot x_{ijt} &\leq T \cdot \sum_{m=1}^M m \cdot y_{im} &i \in I \\
    \sum_{t \in \left[0,T \cdot M \right]}x_{ijt} &\leq w_{ij} &i \in I, j \in J_i \\
    \sum_{m=1}^M y_{im} &\le 1 &i \in I \\
    w_{ij} &\le  \sum_{m = 1}^M y_{im} &i \in I,  j \in J_i \\
    \sum_{i \in I\mid j \in J_i} w_{ij}   &\le 1 &j \in J \label{eq_scuassign} \\
    w_{ij} + \sum_{v \in A_j \cap J_i} \left(q_{ijv} - q_{ivj} \right) - \sum_{v \in J_i \mid \atop i=j} w_{iv} &= 0 &i \in I,  j \in J_i \\
    \left|J_i\right|\cdot w_{ij} - \sum_{v \in A_j \cap J_i} q_{ivj} &\geq 0 &i \in I, j \in J_i 
\end{align}
\normalsize


%\end{minipage}

\end{frame}


\section{Column Generation Procedure}


\begin{frame}{\textbf{Subproblem}}
\textbf{Reduced Cost Function of $x_{ijt}$}
\begin{equation}\label{eqredcost}
\overline{p}_{ij}(t) =  p_{ij}(t) -  t \cdot \sigma_i  - \gamma_{ij}
\end{equation}
\textbf{dual variables} $\sigma_{i}$ and $\gamma_{ij}$ correspond to
\begin{align*}
\text{Time Allocation} &&   \sum_{ j \in J_i} \sum_{t\in [0,T \cdot M]} t \cdot x_{ijt}  & \leq T \cdot \sum_{m = 1}^M m \cdot y_{im}   & \left(\sigma_{i}\right)&& i \in I \\
\text{SCU Assignment} &&   \sum_{t \in \left[0,T \cdot M \right]}x_{ijt} & \leq w_{ij}  & \left(\gamma_{ij}\right)&& i \in I, j \in J_i 
\end{align*}
\textbf{{Subproblem}}\\
Maximize \eqref{eqredcost} with respect to $t$ and check 
\begin{equation} \label{sfd-pricing}
\forall \ i \in I, j \in J, t \in [0,T \cdot M]: \hspace{0.25cm} 
\overline{p}_{ij}(t) \le 0  
\end{equation}
\end{frame}

\begin{frame}{\textbf{Solution of the Subproblem}}
Reduced cost function based on examplary sales response function \eqref{sfd-sales-response-function}
\[
  \overline{p}_{ij}(t) =   c_{ij} \cdot t^b - o_{ij} t  - \sigma_i t - \gamma_{ij}  
\]
\vspace{-1mm}
\noindent Differentiating with respect to $t$ and setting the derivative equal to zero leads to: 
\vspace{-1mm}
\begin{equation}
              b \cdot c_{ij} \cdot t^{b-1} - o_{ij} - \sigma_i = 0 
\end{equation}

\centerline{$\Downarrow$}
\vspace{-4mm}
\begin{equation} 
  t_{ij}^* = \left\{ \begin{array}{c@{\quad:\quad}l}
          \min \left(  \left({\frac{ o_{ij} + \sigma_i } { b \cdot
          c_{ij}}}\right)^{ \frac{1}{(b-1)}},T \cdot M \right)
                     & 
                   o_{ij} +  \sigma_i > 0\\
              T \cdot M &  \mbox{otherwise}
 \end{array} \right.
\end{equation} 

\vspace{-1mm}

 $ \overline{p}_{ij} (t_{ij}^*) > 0$ $\Rightarrow$ $T_{ij} \cup \left\{t_{ij}^*\right\}$\\[1.5ex]
 $ \overline{p}_{ij} (t_{ij}^*) \le 0 \; \;\forall \ i,j$ $\Rightarrow$ optimal solution of LP-relaxation

\end{frame}



\subsection{Branch-and-Bound}

\begin{frame}{\textbf{Branch-and-Bound}}

\textbf{Integer solution:}
\begin{itemize}
    \item perform column generation in each node of a B\&B tree
        \begin{enumerate}
            \item Branch on non-integer locational variables $y_{im}$
                \begin{itemize}
                    \item Idea: define $I':= I \setminus \{i: y_{im} \in \{0,1\} \ \ \forall m \in \{1,\dots,M\}\}$
                    \item $\forall i \in I'$ compute $ \mathfrak{m}_i = \sum_{m =1}^M m \cdot y_{im}$ 
                    \item find $k = \arg \min_{i\in I'}|\lfloor \mathfrak{m}_i \rceil- \mathfrak{m}_i|$ 
                    \item branch on $y_{k,\lfloor \mathfrak{m}_{k} \rceil}$
                \end{itemize}
            \item Branch on non-integer assignment variables $w_{ij}$
        \end{enumerate}
    \item Backtracking:
        \begin{itemize}
            \item an improved lower bound $\underline{F}$ was found
            \item $\frac{\overline{F}^{LP}}{\underline{F}} \leq 1 + \eta$ (e.g. $\eta = 0.001$)
            \item a node was considered two times
        \end{itemize}
    \item Termination: all nodes are fathomed or a predefined maximum computation time is reached
\end{itemize}
    
\end{frame}

\section{Instance generation}


\begin{frame}{\textbf{Artificial Sales Area - Instance generation}}
\vspace{-2mm}
\textbf{Additional Symbols}
\vspace{-1.5mm}
\begin{description}
  \item[$\tilde{d}_{jv}$] distance in travel time units between SCUs $j$ and $v$ with $\tilde{d}_{jv|v \in A_j} \sim \mathcal{U}[0.5,1.5]$, $\tilde{d}_{jv|v \notin A_j}=\infty$
  \item[$d_{ij}$] distance of the shortest path from candidate location $i$ to SCU $j$ in travel time units
\end{description}
\vspace{-1.5mm}
\textbf{Profit contribution function}
\vspace{-1.5mm}
\begin{itemize}
\item $p_{ij}(t) = \alpha \cdot \mu \cdot n_j \, (\, (\, 1- \beta_{ij} \,)\, t\, ) ^ b - h \cdot \beta_{ij} \cdot t$
\item $\alpha \cdot \mu = 125$; $b=0.35$; $h=20$
\item $n_j \sim \mathcal{U}\{5,85\}$
\item $\beta_{ij}=0.1+ \min \{0.9,2 \cdot d_{ij}/8\} $
\end{itemize}

\vspace{-1.5mm}
\textbf{Sets and parameters}
\vspace{-1.5mm}
\begin{itemize}
    \item $j \in J_i|d_{ij} < 3.6$ 
%    \item $f_{im} = R_i \cdot m^\rho + S \cdot m= 1000 \cdot m^0.65 + 36000 \cdot m
 %   \item  R_i=\max()
\end{itemize}

\end{frame}

\begin{frame}
\frametitle{CG - Graphical Representation}
\begin{center}
\begin{figure}
    \centering
    \includegraphics[width=0.8\linewidth]{p1.png}
\end{figure}
\end{center}
\end{frame}

\begin{frame}
\frametitle{CG - Graphical Representation}
\begin{center}
\begin{figure}
    \centering
    \includegraphics[width=0.8\linewidth]{p2.png}
\end{figure}
\end{center}
\end{frame}

\begin{frame}
\frametitle{CG - Graphical Representation}
\begin{center}
\begin{figure}
    \centering
    \includegraphics[width=0.8\linewidth]{p3.png}
\end{figure}
\end{center}
\end{frame}

\begin{frame}
\frametitle{CG - Graphical Representation}
\begin{center}
\begin{figure}
    \centering
    \includegraphics[width=0.8\linewidth]{p4.png}
\end{figure}
\end{center}
\end{frame}

\begin{frame}
\frametitle{CG - Graphical Representation}
\begin{center}
\begin{figure}
    \centering
    \includegraphics[width=0.8\linewidth]{p5.png}
\end{figure}
\end{center}
\end{frame}

\begin{frame}
\frametitle{CG - Graphical Representation}
\begin{center}
\begin{figure}
    \centering
    \includegraphics[width=0.8\linewidth]{p6.png}
\end{figure}
\end{center}
\end{frame}

\begin{frame}
\frametitle{CG - Graphical Representation}
\begin{center}
\begin{figure}
    \centering
    \includegraphics[width=0.8\linewidth]{p7.png}
\end{figure}
\end{center}
\end{frame}

\begin{frame}{Example}
    Assuming $\mid I \mid$=1, M:\{1,2,3\}, $y_{i1}=0.4$, $y_{i2}=0.4$, and $y_{i3}=0.2$ without (8)-(12)
    \vspace{-2mm}
   \begin{center}
\begin{figure}
    \centering
    \includegraphics[width=0.7\linewidth]{cr_FC.png}
\end{figure}
\end{center}
 \vspace{-7mm}
FC=$\sum_{i \in I} \sum_{m=1}^M f_{im} y_{im}$
\end{frame}

\begin{frame}{Example: Piece wise linearisation of fixed cost }
    Assuming $\mid I \mid$=1, M:\{1,2,3\}, $y_{i1}=0.4$, $y_{i2}=0.4$, and $y_{i3}=0.2$ without (8)-(12)\\ \\ \\
   $ \theta_{i1}=1 $ due to (8):
       \begin{align*}
        y_{im} &\leq \theta_{im} & \forall i, m = 1
    \end{align*}
    $\theta_{i1}=1$ and $\theta_{i2}$ can take values of $\{0,1\}$ due to (8)-(9):
       \begin{align*}
        y_{im} &\leq \theta_{im} & \forall i, m = 1\\
        y_{im} &\leq \theta_{i,m-1} + \theta_{im}  & \forall i, m = 2 
    \end{align*}
\end{frame}

\begin{frame}{Example: Piece wise linearisation of fixed cost }
    $\theta_{i1}=1$ and $\theta_{i2}=1$ due to (8)-(10):
    \begin{align*}
        y_{im} &\leq \theta_{im} & \forall i, m = 1\\
        y_{im} &\leq \theta_{i,m-1} + \theta_{im}  & \forall i, m = 2 \\
        y_{im} &\leq \theta_{i,m-1} & \forall i, m = 3
    \end{align*}
 $\theta_{i1}=0$ and $\theta_{i2}=1$ due to (8)-(11):
    \begin{align*}
        y_{im} &\leq \theta_{im} & \forall i, m = 1\\
        y_{im} &\leq \theta_{i,m-1} + \theta_{im}  & \forall i, m = 2 \\
        y_{im} &\leq \theta_{i,m-1} & \forall i, m = 3 \\
        \sum_{m=1}^{M-1} \theta_{im} &= 1 & \forall i 
    \end{align*}
  
\end{frame}

\begin{frame}{Example: Piece wise linearisation of fixed cost }
    $\theta_{i2}=1$ indicates that the fixed cost is located in the second segment of the fixed cost curve, forcing $y_{i1}=0$ and $y_{i2}=1.$

         \begin{center}
\begin{figure}
    \centering
    \includegraphics[width=0.65\linewidth]{ap_FC.png}
\end{figure}
\end{center}
\end{frame}
\end{document}
